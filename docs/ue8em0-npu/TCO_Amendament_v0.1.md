# (Addendum) TCO 확장 섹션 — 주파수, 공정, NRE 의사결정 가이드

> 본 섹션은 **TFusionTensor v0.2 / TFusionVcache v0.1** 문서의 **TCO** 파트를 확장 설명합니다.  
> 목표: 왜 우리의 **최적 동작 클럭**이 0.50–0.55 GHz 영역(DDR/HBM 스윗스팟)인지, 공정 이동(7→5→4→3 nm)이 전성비에 어떤 영향을 주는지,  
> 그리고 **NRE(비반복성 비용, Non Recurrence Engineering Cost)**을 포함한 단가/ROI 관점에서 어떤 의사결정 흐름이 타당한지를 **학부생/주니어 엔지니어**도 바로 적용할 수 있도록 제시합니다.

---

## 1) 1차 원리: 성능·전력·지연의 상관식

- Peak OPS(이론치) ≈ (#PEs × ops/PE/clk) × **f** × 효율(η)  
- 동적전력 `P_dyn ≈ C · V^2 · f` (C: 유효 스위칭 커패시턴스)  
- 지연(latency)은 **메모리 병목**에서 지배되므로, 유효 대역폭 `B_eff` 와 연산집약도 `I(ops/byte)`에 의해
  - **Roofline**의 무릎에서 `f_knee ≈ (B_eff · I) / (ops/clk)` 로 근사 가능  
- 결론: **Perf/W = (OPS) / (P_dyn+P_leak+P_io+P_mem)** 는 보통 **중간 f**에서 최대가 된다.  
  - 이유: V를 올릴수록 OPS는 선형↑이지만, f가 상승해 `V^2 f`가 과도하게 증가하고, 메모리 병목/열·쿨링·PDN 비용이 동반상승.

> ASIC-miner 업계와 동일한 교훈: **언더클럭으로 전성비와 TCO가 좋아지는 영역**이 존재한다.

---

## 2) 왜 0.50–0.55 GHz인가? (우리 설계의 스윗스팟)

- **DDR SKU**: 외부 메모리 병목을 줄이기 위해 **Front-side TFusionVcache(64 MB)**와 **SPM**을 앞세움. 그 결과 **0.50 GHz**에서 이미 roofline 무릎에 근접.  
- **HBM SKU**: 메모리 여유가 있어 **0.55 GHz**까지 올려도 `Perf/W` 이득이 남음. 그 이상은 `fV^2` 페널티가 커지고 열·PDN·쿨링 비용이 급상승.  
- **운영 가이드**: 기본 `f_base=0.50 GHz`, HBM 스윗스팟 `f_hbm≈0.55 GHz`, 상황에 따른 **DVFS 단계(0.60/0.70/0.80)**는 **부하 스파이크/서비스-SLA 대응용**.

> 간단 모델(예시): `V@0.50=0.75 V, V@0.55=0.78 V, V@0.70=0.85 V`라면 `P_dyn`은 0.50→0.55에서 **+12% 내외**, 0.55→0.70에서 **+33% 내외** 상승.  
> 반면 0.55→0.70에서 메모리-바운드라 OPS 증가는 제한적이므로 **Perf/W**는 악화.

---

## 3) 공정 이동(7→5→4→3 nm)과 전성비 — 계획용 선형화 모델

공정이 미세화되면 **C↓, V↓** 경향으로 **에너지/연산**이 감소하지만, **누설전력·수율·변동성** 이슈가 커질 수 있음.  
실측치는 파운드리·PDK·배선층·설계에 따라 크게 달라지므로, **초기 기획 단계**에서는 다음과 같은 **선형 근사(플래닝용)**를 권장:

- **에너지/연산 상대치(예시)**  
  - 7 nm: **1.00** (baseline)  
  - 5 nm: **0.82** (–18%)  
  - 4 nm: **0.75** (–25%)  
  - 3 nm: **0.66** (–34%)  

> 주의: 이는 **기획 단계용 러프 가이드**입니다. 실제 값은 라이브러리 선택, 셀 수, 배선 RC, 클럭 트리, V-f 커브, 공정 옵션에 따라 달라집니다.  
> 특히 3 nm에서는 누설·공정변동 영향으로 **저주파 전성비 이득이 예상보다 작아질 수 있음**을 염두에 두세요.

---

## 4) NRE와 단가(단위 원가) — ROI 프레임

**TCO/unit = (Silicon + Packaging + HBM/DDR + Board/PDN + Cooling) + Energy(OPEX) + Network/Rack + Test/Assembly + (NRE / Volume)**

- **NRE 구성**: 마스크셋, IP 라이선스, EDA/검증, DFT/ATE 패턴, bring-up, 펌웨어, 패키징(예: HBM 인터포저/기판), 방열/메카 비용.  
- **노드 선택의 경제성**: 공정 미세화로 **에너지/연산↓**와 **실리콘 면적↓** 이익이 있으나, **NRE↑**와 **패키징 난이도↑**가 커짐.  
- **손익분기 물량(Volume\_BE)** 근사:
  - `Volume_BE ≈ (NRE_new − NRE_old) / (UnitCost_old − UnitCost_new)`  
  - 에너지 비용까지 포함하면 `UnitCost`에 **전력×시간×요금**을 가산.  
- **권장**: 7/5 nm에서 **설계 성숙도 확보** → 4/3 nm 이전 시 **전성비/면적 이득**과 **추가 NRE**의 **분자/분모**가 맞는지 계산.

## 3) 공정 이동(7→5→4→3 nm)과 전성비 — 계획용 선형화 모델 (2025년 기준)

공정이 미세화되면 **C↓, V↓** 경향으로 **에너지/연산**이 감소하지만, 동시에 **누설전력↑, 수율↓, 변동성↑** 이슈가 커질 수 있습니다.  
또한 실제 수치는 **파운드리/PDK/배선/라이브러리** 조건에 따라 달라지므로, 초기 기획 단계에서는 다음과 같은 **선형 근사(플래닝용)**를 참고할 수 있습니다.

- **에너지/연산 상대치(예시)**  
  - 7 nm: **1.00** (baseline)  
  - 5 nm: **0.82** (–18%)  
  - 4 nm: **0.75** (–25%)  
  - 3 nm: **0.66** (–34%)  

⚠️ 주의: 이는 어디까지나 **기획 단계용 러프 가이드**입니다.  
실제 값은 셀 수, 배선 RC, 클럭 트리, V-f 커브, 공정 옵션에 따라 달라집니다. 특히 3 nm에서는 **누설 전류 및 공정 변동성**으로 인해 저주파 전성비 이득이 예상보다 작아질 수 있습니다.

---

## 4) NRE와 단가(단위 원가) — ROI 프레임 (2025년 현재)

**TCO/unit = (Silicon + Packaging + HBM/DDR + Board/PDN + Cooling) + Energy(OPEX) + Network/Rack + Test/Assembly + (NRE / Volume)**

- **NRE 구성**: 마스크셋, IP 라이선스, EDA/검증, DFT/ATE, bring-up, 펌웨어, 패키징(HBM 인터포저/기판), 방열/메카 비용.  
- **노드 선택의 경제성**:  
  - 7 nm, 5 nm → **성숙 노드**, Yield↑, Fab PDK 및 3rd Party IP 비용↓, Wafer 단가 안정적.  
  - 4 nm, 3 nm, 2 nm → **첨단 노드**, Yield↓, Delivery 불확실성↑, Fab PDK 안정성↓, Wafer 단가↑ → **Total Cost 상승**.  
- **손익분기 물량(Volume_BE)** 근사:  
  - `Volume_BE ≈ (NRE_new − NRE_old) / (UnitCost_old − UnitCost_new)`  
  - UnitCost에는 **전력×시간×요금**을 포함해 계산해야 함.  
- **권장 (2025년 현재)**:  
  - **7 nm / 5 nm**에서 **설계 성숙도** 확보 후,  
  - **4 nm / 3 nm** 이전은 전성비/면적 이득과 추가 NRE/리스크의 분자/분모가 맞는지 반드시 검토해야 함.  

---

📌 **2025년 현황**  
- 7 nm, 5 nm: 성숙 공정, 대량생산 경험 축적, Wafer 가격/PDK/IP License 비용 상대적으로 저렴.  
- 4 nm, 3 nm: 최신 공정으로 Yield·Delivery 변동성이 크고, Fab/PDK 안정성이 충분히 검증되지 않음. Silicon Wafer 가격도 상승 추세.  
- 따라서 **현재는 TCO를 고려한 합리적 의사결정**이 필요하며, 단순히 노드 shrink 만으로 전성비가 좋아진다고 판단하면 위험함.

---

## 5) 실무 의사결정 체크리스트

1. **워크로드 프로파일링**: `I(ops/byte)`, **B_eff**, 타겟 지연/SLA.  
2. **f_knee 산출**: roofline 무릎, `f* = min(f_knee, 열/PDN 한계)` 선택.  
3. **전성비 커브 측정**: `Perf/W(f)` 실측 → **최댓값 근처**에서 기본 f 고정, 상/하 DVFS 가드 추가.  
4. **노드별 PPA 테이블**: (에너지/연산, 면적, 누설, 타이밍 여유) × (NRE, 패키징, 리스크).  
5. **Volume_BE**로 노드 선택의 경제성 판단.  
6. **운영 정책**: TFusionVcache 파티션/프리패처/Bypass를 동조해 **DRAM 왕복 최소화**.

## 부록: 공정별 웨이퍼 비용 및 실리콘 단가 추정 (2025년 기준, Die=500mm²) 

| Node   |   Die_Area_mm2 |   Wafer_Cost_USD | Wafer_Cost_Range_USD   |   Gross_Dies_per_Wafer |   Assumed_Yield |   Good_Dies |   Silicon_Cost_per_Die_USD | Notes                                            |
|:-------|---------------:|-----------------:|:-----------------------|-----------------------:|----------------:|------------:|---------------------------:|:-------------------------------------------------|
| 7nm    |            500 |             9346 | 9000–10000             |                  111.6 |            0.7  |        78.1 |                     119.67 | Edit yield & costs; excludes packaging/test/HBM. |
| 5nm    |            500 |            16988 | 16000–17000            |                  111.6 |            0.65 |        72.5 |                     234.26 | Edit yield & costs; excludes packaging/test/HBM. |
| 4nm    |            500 |            18500 | 18000–20000            |                  111.6 |            0.6  |        66.9 |                     276.36 | Edit yield & costs; excludes packaging/test/HBM. |
| 3nm    |            500 |            20000 | 18000–25000            |                  111.6 |            0.55 |        61.4 |                     325.93 | Edit yield & costs; excludes packaging/test/HBM. |
| 2nm    |            500 |            30000 | 30000–35000            |                  111.6 |            0.45 |        50.2 |                     597.54 | Edit yield & costs; excludes packaging/test/HBM. |

📄 Full CSV: [WaferCost_UnitCost_Estimator_v2025.csv](WaferCost_UnitCost_Estimator_v2025.csv)

---

## 6) 한 줄 요약

- **언더클럭 + 캐시/프리패치 최적화**가 **Perf/W와 TCO**를 동시에 개선하는 경우가 많다.  
- 공정은 **전성비 이득 vs NRE/리스크**의 **분자/분모**를 숫자로 비교해 결정한다.  
- 운영은 **TFusionVcache**로 **메모리 왕복을 줄이는 것**이 핵심이다.
